## Typen der Injektion
- script language command injections  
- OS command injections
- SQL injections
- Xpath-Injections
- LDAP-Injections

## Gut gemeinte Security
- Verschlüsselte Datenbank
	- aber der Schlüssel liegt auf der Maschine
- Hashed Passwörter
	- aber kein Salt und Pepper
	- Rainbow Tables verhelfen zum Cracken

## XML External Entity (XXE)
- Externe Datei in XML injecten
- Dabei z.B: auch vorhandene Dateien überschreiben wie /etc/passwd

![[xml-external-entity-1.png]]

- Der Wert kann eine externe URI sein, die aufgerufen wird - Oder auch eine lokale Datei

![[xml-external-entity-2.png]]

- Der "Exploit" ist, dass man diese Entity selbst spezifizieren und dann nutzen kann, sofern die Webseite die Eingaben in sein XML einbettet

![[xml-external-entity-3.png]]

## Broken Access Control
- User führen Funktionen aus, die sie normalerweise nicht ausführen dürften
- Ein Hacker schaut zum Beispiel in den Session Cookie, verändert diesen und wird zum Admin mit Adminrechten (nimmt seine Identität an)

## Security Misconfiguration
- meist hat man "face palm" Momente, doch *es ist eine der häufigsten Fehler laut OWASP*

- Beispiele dafür:
	- Default Passwörter genutzt
	- Oder Directory Listing angeschaltet (also das Traversierung durch die Verzeichnisstruktur wurde per Konfiguration erlaubt)
	- Nicht geschütztes *PHPMyAdmin* oder andere Tools
	- Offene Ports bzw. nicht mehr benötigte Services, die darauf lauschen
	- Schlechte Konfiguration für Webserver
	- Error Messages, die an den Client gehen, mit zu vielen Informationen

## Cross Site Scripting (XSS)
- DOM = *Document Object Model*

## Insecure deserialization
- Serialisierung: Objekt -> JSON
	- Objekt als Binärdaten speichern
	- Über Netzwerk transportieren
- Deserialisierung JSON -> Objekt

- Die Attacke funktioniert zum Beispiel so, dass:
	- 1) Eine Anwendung lässt den User eine Klasse serialisieren
	- 2) Ein Angreifer serialisiert die Klasse so, dass er eine interne Methode (bei pickle von Python z.B: *__reduce__*) so überschreibt, dass ein *os.system* mit bestimmten Argumenten ausführt wird
	- 3) In diesem String steckt Code für eine Reverse Shell

## Veraltete Software mit bekannten Schwachstellen
- gibts nicht viel zu zu sagen
- *Software regelmäßig updaten!!*

## Ungenügendes Logging und Monitoring
- einer der wenigen Punkte bei der OWASP Top 10, die die ein "Systemadministrator- Problem" ist und kein "Programmier-Problem"
- Hacking wird nicht erkannt, weil es kein Logging oder keine Erkennung für Angriffe gibt
- HIDS = *Hostbasiertes Intrusion Detection System*
- NIDS = *Network-based Intrusion Detection System*
- Achtung vor *Over-Logging!* (z.B: Passwörter in Logs speichern)

## Cross-Site Request Forgery (CSRF)
- z.B: führt injeziert man auf dem Browser des Nutzers Code und bringt bei einem Klick auf einen Button ihn dazu, etwas ganz anderes zu tun (zusätzlich zu seiner aktuellen Sache)
	- User will Blog-Post abschicken
	- Schickt im Hintergrund Request, um eine Einbauküche zu kaufen
- Lösungmöglichkeit 1) Token erstellen auf Webseite, jedes Mal wenn die Form geladen wird. Der Angreifer kennt diesen Token nicht.
- Lösungsmöglichkeit 2) CAPTCHA nutzen (diese Angriffe sind meist automatisiert, die kommen nicht durchs Captcha)
- Lösungsmöglichkeit 3) Same-Site-Cookies

- HTTP Host Header und Referrer Header sind nicht so gut geeignet, manche Ad-Blocker modifizieren diese oder senden sie gar nicht mit. Außerdem können sie gespoofed werden.

## Server Side Request Forgery (SSRF)
- Man trickst den Server so aus, dass er einen Request an ein Ziel schickt, das so nicht vorgesehen war. z.B: ein Ping, LDAP oder HTTP Request
- z.B: Wenn ein Web-Shop-Backend nur Requests für Zahlungen von seinem bekannten Web-Finance-Backend akzeptiert. Dann trickst man das Web-Finance-Backend aus und nutzt ihn als Middle-Man für Requests.

## Underprotected API
- Nichts hinzuzufügen
- Sichert neben Web Interfaces auch eure API's ihr Banausen!

## Race Conditions ("TOCTOU" - Time Of Change to Time Of Use)
- A und B wollen Flugplätze sichern
	- Schritt 1: Es wird geprüft, ob der Platz noch verfügbar ist
	- Schritt 2: Wenn ja, wird dem Passagier der Platz zugeschrieben
- Durch fehlende Transaktion in einem Multi-Threaded-System, könnte B den Platz von A überschreiben. Beispiel:
	- A, Schritt 1
	- B, Schritt 1
	- A, Schritt 2
	- B, Schritt 2

## Encoding Issues
- z.B: Führende Nullen bei der IP Adresse werden entfernt, statt der .100 am Ende, spricht man mit der .1

## Verhindern dieser Probleme
- Codingstandards einhalten
- Peer-Reviews
- Pentesting